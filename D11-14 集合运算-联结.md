# 集合运算-联结

`UNION`是以行（纵向）为单位进行操作，而联结则是以列（横向）为单位进行的，**联结`JOIN`就是将其他表中的列添加过来，进行“添加列”的集合运算   

**应用场景：使用`JOIN`联结从多张表（>=3亦可）中选取数据。**

## 内联结--INNER JOIN
**可以配合`WHERE  HAVING GROUP BY ORDER BY`一起使用**  
示例：
```
mysql> SELECT SP.id, SP.name, SP.pid, PRO.name, PRO.sprice  #SELECT 后面是<表的别名>.<列明>，如果在下面重命名则如上面的写法，否则需写<表全称>.<列名>
    -> FROM SP AS SP INNER JOIN PRO AS PRO      #此处使用的<别名>通过AS重命名表名称，般当表名称较长是使用，重命名可以简化查询语句，降低出错。
    -> ON SP.pid = PRO.id;
+------+-----------+------+------------+--------+
| id   | name      | pid  | name       | sprice |
+------+-----------+------+------------+--------+
| 000A | 东京      | 0001 | T恤衫      |   1000 |
| 000A | 东京      | 0002 | 打孔器     |    500 |
| 000A | 东京      | 0003 | 运动T恤    |   4000 |
| 000B | 名古屋    | 0002 | 打孔器     |    500 |
| 000B | 名古屋    | 0003 | 运动T恤    |   4000 |
| 000B | 名古屋    | 0004 | 菜刀       |   3000 |
| 000B | 名古屋    | 0006 | 叉子       |    500 |
| 000B | 名古屋    | 0007 | 擦菜板     |    880 |
| 000C | 大阪      | 0003 | 运动T恤    |   4000 |
| 000C | 大阪      | 0004 | 菜刀       |   3000 |
| 000C | 大阪      | 0006 | 叉子       |    500 |
| 000C | 大阪      | 0007 | 擦菜板     |    880 |
| 000D | 福冈      | 0001 | T恤衫      |   1000 |
+------+-----------+------+------------+--------+
13 rows in set (0.00 sec)

mysql> SELECT SP.id, SP.name, SP.pid, PRO.name, PRO.sprice
    -> FROM SP INNER JOIN PRO                         #由于原表名已经很简洁，故不再重命名
    -> ON SP.pid = PRO.id 
    -> WHERE SP.id = '000A';                          #ON 作为桥梁写明“联结条件”，必须用在WHERE之前。
+------+--------+------+------------+--------+
| id   | name   | pid  | name       | sprice |
+------+--------+------+------------+--------+
| 000A | 东京   | 0001 | T恤衫      |   1000 |
| 000A | 东京   | 0002 | 打孔器     |    500 |
| 000A | 东京   | 0003 | 运动T恤    |   4000 |
+------+--------+------+------------+--------+
3 rows in set (0.00 sec)
```

## 外联结
示例：
```
mysql> SELECT A.id, A.name, A.pid, B.name, B.sprice
    -> FROM SP AS A RIGHT OUTER JOIN PRO AS B
    -> ON A.pid = B.id;
+------+-----------+------+------------+--------+
| id   | name      | pid  | name       | sprice |
+------+-----------+------+------------+--------+
| 000A | 东京      | 0001 | T恤衫      |   1000 |
| 000A | 东京      | 0002 | 打孔器     |    500 |
| 000A | 东京      | 0003 | 运动T恤    |   4000 |
| 000B | 名古屋    | 0002 | 打孔器     |    500 |
| 000B | 名古屋    | 0003 | 运动T恤    |   4000 |
| 000B | 名古屋    | 0004 | 菜刀       |   3000 |
| 000B | 名古屋    | 0006 | 叉子       |    500 |
| 000B | 名古屋    | 0007 | 擦菜板     |    880 |
| 000C | 大阪      | 0003 | 运动T恤    |   4000 |
| 000C | 大阪      | 0004 | 菜刀       |   3000 |
| 000C | 大阪      | 0006 | 叉子       |    500 |
| 000C | 大阪      | 0007 | 擦菜板     |    880 |
| 000D | 福冈      | 0001 | T恤衫      |   1000 |
| NULL | NULL      | NULL | 高压锅     |   6800 |    #此处多了2列控制列表！！！与内联结的区别
| NULL | NULL      | NULL | 圆珠笔     |    100 |
+------+-----------+------+------------+--------+
15 rows in set (0.00 sec)
```
#### 外联结要点
**1.需制定主表，通过`LEFT`和`RIGHT`来指定，RIGHT就是说FROM子句中右侧的是主表，LEFT即FROM子句中左侧的是主表；  
2.选取 “ 主表 ” 的全部信息；**

### 3张表以上表的联结
只能使用**内联结**来联结多张表  
示例：新建一直表IP
```
mysql> SELECT * FROM ip;\
+------+------+-----+
| tid  | pid  | qty |
+------+------+-----+
| P001 | 0001 |   0 |
| P001 | 0002 | 120 |
| P001 | 0003 | 200 |
| P001 | 0004 |   3 |
| P001 | 0005 |   0 |
| P001 | 0006 |  99 |
| P001 | 0007 | 999 |
| P001 | 0008 | 200 |
| P002 | 0001 |  10 |
| P002 | 0002 |  25 |
| P002 | 0003 |  34 |
| P002 | 0004 |  19 |
| P002 | 0005 |  99 |
| P002 | 0006 |   0 |
| P002 | 0007 |   0 |
| P002 | 0008 |  18 |
+------+------+-----+
16 rows in set (0.00 sec)

mysql> SELECT A.id, A.name, A.pid, B.id, B.name, B.sprice, C.qty
    -> FROM SP AS A INNER JOIN PRO AS B
    ->    ON A.pid = B.id
    ->      INNER JOIN IP AS C
    ->      ON A.pid = C.pid
    -> WHERE C.tid = 'P001';
+------+-----------+------+------+------------+--------+-----+
| id   | name      | pid  | id   | name       | sprice | qty |
+------+-----------+------+------+------------+--------+-----+
| 000A | 东京      | 0001 | 0001 | T恤衫      |   1000 |   0 |
| 000A | 东京      | 0002 | 0002 | 打孔器     |    500 | 120 |
| 000A | 东京      | 0003 | 0003 | 运动T恤    |   4000 | 200 |
| 000B | 名古屋    | 0002 | 0002 | 打孔器     |    500 | 120 |
| 000B | 名古屋    | 0003 | 0003 | 运动T恤    |   4000 | 200 |
| 000B | 名古屋    | 0004 | 0004 | 菜刀       |   3000 |   3 |
| 000B | 名古屋    | 0006 | 0006 | 叉子       |    500 |  99 |
| 000B | 名古屋    | 0007 | 0007 | 擦菜板     |    880 | 999 |
| 000C | 大阪      | 0003 | 0003 | 运动T恤    |   4000 | 200 |
| 000C | 大阪      | 0004 | 0004 | 菜刀       |   3000 |   3 |
| 000C | 大阪      | 0006 | 0006 | 叉子       |    500 |  99 |
| 000C | 大阪      | 0007 | 0007 | 擦菜板     |    880 | 999 |
| 000D | 福冈      | 0001 | 0001 | T恤衫      |   1000 |   0 |
+------+-----------+------+------+------------+--------+-----+
13 rows in set (0.00 sec)
```
## 交叉联结--CROSS JOIN
**又称为：笛卡尔积，实际应用中很少使用，故不做记录。详见《SQL基础教程（第2版）》P249**



